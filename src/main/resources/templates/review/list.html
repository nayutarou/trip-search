<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{ layout :: head('自分の口コミ一覧', @{/css/review/list-style.css})}"></head>
<body>
<div class="header">
    <a th:href="@{/spots}"><span>←</span> 検索ページへ</a>
    <h1>口コミ一覧ページ</h1>
</div>
<div class="container">
    <h2>自分の口コミ一覧</h2>
    <a th:href="@{/reviews/new}" class="add-review-link">新しい口コミを投稿する</a>

    <div th:if="${#lists.isEmpty(myReviews)}" class="no-reviews">
        <p>まだ投稿した口コミはありません。</p>
    </div>

    <div class="review-list" th:unless="${#lists.isEmpty(myReviews)}">
        <div class="review-card" th:each="item : ${myReviews}">
            <div class="review-card-header">
                <h2 class="place-name" th:text="${item.spot.name}">場所の名前</h2>
                <div class="rating-display" th:style="'--rating: ' + ${item.review.rating} + ';'"></div>
            </div>
            <div class="review-card-body">
                <img th:if="${item.review.imagePath != null}"
                     th:src="@{/images/reviews/{imageName}(imageName=${item.review.imagePath})}" alt="口コミ写真"
                     class="review-image">
                <p class="review-comment" th:text="${item.review.comment}">口コミのコメントがここに入ります。</p>
            </div>
            <div class="review-card-footer">
                <div class="date-info">
                        <span th:if="${item.review.visitedAt != null}"
                              th:text="'訪問日: ' + ${#temporals.format(item.review.visitedAt, 'yyyy年MM月dd日')}"></span>
                    <span th:text="'投稿日: ' + ${#temporals.format(item.review.createdAt, 'yyyy年MM月dd日')}"></span>
                </div>
                <!-- ★★★ 編集・削除ボタンを追加 ★★★ -->
                <div class="action-buttons">
                    <a th:href="@{/reviews/{id}/edit(id=${item.review.reviewId})}" class="btn edit-btn">編集</a>
                    <form th:action="@{/reviews/{id}/delete(id=${item.review.reviewId})}" method="post" onsubmit="return confirm('本当に削除しますか？');">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button type="submit" class="btn delete-btn">削除</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>